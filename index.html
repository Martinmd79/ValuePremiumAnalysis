<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Value Premium Analysis - Interactive Visualization</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/recharts@2.8.0/umd/Recharts.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f8fafc;
        }
        .academic-header {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            text-align: center;
        }
        .citation-note {
            background-color: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 1rem;
            margin: 2rem 0;
            border-radius: 0 8px 8px 0;
        }
    </style>
</head>
<body>
    <div class="academic-header">
        <h1 class="text-3xl font-bold mb-2">Value Premium Time Series Analysis</h1>
        <p class="text-lg opacity-90">Interactive Visualization of Global Value Premiums (1993-2024)</p>
        <p class="text-sm opacity-75 mt-2">Academic Assignment - Finance 301 | Assessment 1 Task 3</p>
    </div>

    <div class="citation-note">
        <h3 class="font-semibold text-amber-800 mb-2">ðŸ“Š Interactive Visualization Instructions:</h3>
        <p class="text-amber-700 text-sm">
            Click on region names in the legend or use the checkboxes to toggle visibility. 
            Hover over data points for detailed values. This interactive chart supplements the static analysis in the main report.
        </p>
    </div>

    <div id="root"></div>

    <footer class="mt-8 p-4 bg-gray-100 rounded-lg text-center text-sm text-gray-600">
        <p><strong>Data Source:</strong> Global Market Risk Premium and Value Premiums across Regions (French Data Library)</p>
        <p><strong>Period:</strong> January 1993 - December 2024 | <strong>Frequency:</strong> Monthly</p>
        <p class="mt-2"><em>This visualization is part of an academic assessment on value premium analysis.</em></p>
    </footer>

    <script type="text/babel">
        const { useState } = React;
        const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, ReferenceLine } = Recharts;

        const ValuePremiumChart = () => {
            // Your actual data would go here - for demo purposes using sample data
            const generateDataWithRealValues = () => {
                const data = [];
                const startDate = new Date(1993, 0, 1);
                const endDate = new Date(2024, 11, 31);
                
                // Generate monthly data points
                for (let date = new Date(startDate); date <= endDate; date.setMonth(date.getMonth() + 1)) {
                    const year = date.getFullYear();
                    const month = date.getMonth() + 1;
                    const dateStr = `${year}-${month.toString().padStart(2, '0')}`;
                    
                    // Sample data based on your actual calculated averages
                    // Replace these with your real Excel data
                    const dataPoint = {
                        date: dateStr,
                        year: year,
                        month: month,
                        Developed: (Math.random() - 0.5) * 4 + 0.2462,
                        Emerging: (Math.random() - 0.5) * 4 + 0.7009,
                        Europe: (Math.random() - 0.5) * 4 + 0.3365,
                        Japan: (Math.random() - 0.5) * 5 + 0.3711,
                        AsiaPacific: (Math.random() - 0.5) * 5 + 0.5560,
                        NorthAmerica: (Math.random() - 0.5) * 6 + 0.1246
                    };
                    
                    // Add crisis period spikes
                    if ((year >= 2000 && year <= 2002) || (year >= 2008 && year <= 2009) || year === 2020) {
                        Object.keys(dataPoint).forEach(key => {
                            if (key !== 'date' && key !== 'year' && key !== 'month') {
                                dataPoint[key] += (Math.random() - 0.3) * 8;
                            }
                        });
                    }
                    
                    data.push(dataPoint);
                }
                return data;
            };

            const [selectedRegions, setSelectedRegions] = useState({
                Developed: true,
                Emerging: true,
                Europe: false,
                Japan: false,
                AsiaPacific: false,
                NorthAmerica: false
            });

            const [data] = useState(generateDataWithRealValues());

            const regionColors = {
                Developed: '#2563eb',
                Emerging: '#dc2626',
                Europe: '#059669',
                Japan: '#7c2d12',
                AsiaPacific: '#9333ea',
                NorthAmerica: '#ea580c'
            };

            const regionNames = {
                Developed: 'Developed Markets',
                Emerging: 'Emerging Markets',
                Europe: 'European Markets',
                Japan: 'Japanese Markets',
                AsiaPacific: 'Asia-Pacific (ex Japan)',
                NorthAmerica: 'North American Markets'
            };

            const toggleRegion = (region) => {
                setSelectedRegions(prev => ({
                    ...prev,
                    [region]: !prev[region]
                }));
            };

            // Display every 3rd month for cleaner x-axis
            const displayData = data.filter((_, index) => index % 3 === 0);

            const CustomTooltip = ({ active, payload, label }) => {
                if (active && payload && payload.length) {
                    const year = parseInt(label.split('-')[0]);
                    const month = parseInt(label.split('-')[1]);
                    const monthNames = ['', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                    
                    return (
                        <div className="bg-white p-3 border border-gray-300 rounded shadow-lg">
                            <p className="font-semibold text-gray-800">{`${monthNames[month]} ${year}`}</p>
                            {payload.map((entry, index) => (
                                <p key={index} style={{ color: entry.color }} className="text-sm">
                                    {`${regionNames[entry.dataKey]}: ${entry.value.toFixed(2)}%`}
                                </p>
                            ))}
                        </div>
                    );
                }
                return null;
            };

            return (
                <div className="w-full max-w-7xl mx-auto p-6 bg-white rounded-lg shadow-lg">
                    <div className="mb-6">
                        <h2 className="text-2xl font-bold text-gray-800 mb-2">
                            Interactive Value Premium Analysis
                        </h2>
                        <p className="text-gray-600 text-sm">
                            Monthly HML (High-Minus-Low) value premiums across global regions. 
                            Toggle regions to compare patterns during different market conditions.
                        </p>
                    </div>

                    {/* Region Selection Controls */}
                    <div className="mb-6 p-4 bg-gray-50 rounded-lg">
                        <h3 className="text-lg font-semibold mb-3 text-gray-700">Select Regions to Display:</h3>
                        <div className="grid grid-cols-2 md:grid-cols-3 gap-3">
                            {Object.entries(regionNames).map(([key, name]) => (
                                <label key={key} className="flex items-center space-x-2 cursor-pointer hover:bg-gray-100 p-2 rounded">
                                    <input
                                        type="checkbox"
                                        checked={selectedRegions[key]}
                                        onChange={() => toggleRegion(key)}
                                        className="w-4 h-4"
                                    />
                                    <span 
                                        className="w-4 h-4 rounded" 
                                        style={{ backgroundColor: regionColors[key] }}
                                    ></span>
                                    <span className="text-sm text-gray-700">{name}</span>
                                </label>
                            ))}
                        </div>
                        <div className="mt-3 text-xs text-gray-500">
                            Tip: Select 1-2 regions for clearest comparison
                        </div>
                    </div>

                    {/* Main Chart */}
                    <div className="bg-white border border-gray-200 rounded-lg p-4 mb-6">
                        <ResponsiveContainer width="100%" height={500}>
                            <LineChart data={displayData} margin={{ top: 20, right: 30, left: 20, bottom: 80 }}>
                                <CartesianGrid strokeDasharray="3 3" stroke="#e5e7eb" />
                                <XAxis 
                                    dataKey="date" 
                                    tick={{ fontSize: 10 }}
                                    angle={-45}
                                    textAnchor="end"
                                    height={80}
                                    tickFormatter={(value) => {
                                        const year = value.split('-')[0];
                                        return year;
                                    }}
                                />
                                <YAxis 
                                    domain={[-15, 15]}
                                    tick={{ fontSize: 12 }}
                                    label={{ value: 'Value Premium (%)', angle: -90, position: 'insideLeft' }}
                                />
                                <Tooltip content={<CustomTooltip />} />
                                <Legend 
                                    wrapperStyle={{ paddingTop: '20px' }}
                                    formatter={(value) => regionNames[value]}
                                />
                                <ReferenceLine y={0} stroke="#374151" strokeWidth={1} strokeDasharray="2 2" />
                                
                                {Object.entries(selectedRegions).map(([region, isSelected]) => 
                                    isSelected && (
                                        <Line
                                            key={region}
                                            type="monotone"
                                            dataKey={region}
                                            stroke={regionColors[region]}
                                            strokeWidth={2}
                                            dot={false}
                                            connectNulls={false}
                                        />
                                    )
                                )}
                            </LineChart>
                        </ResponsiveContainer>
                    </div>

                    {/* Analysis Insights */}
                    <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                        <div className="bg-blue-50 p-4 rounded-lg">
                            <h3 className="text-lg font-semibold text-blue-800 mb-2">Crisis Periods</h3>
                            <ul className="text-sm text-blue-700 space-y-1">
                                <li>â€¢ <strong>2000-2002:</strong> Dot-com bubble burst</li>
                                <li>â€¢ <strong>2008-2009:</strong> Global Financial Crisis</li>
                                <li>â€¢ <strong>2020:</strong> COVID-19 pandemic</li>
                                <li>â€¢ <strong>1997-1998:</strong> Asian Financial Crisis</li>
                            </ul>
                        </div>
                        
                        <div className="bg-green-50 p-4 rounded-lg">
                            <h3 className="text-lg font-semibold text-green-800 mb-2">Key Patterns</h3>
                            <ul className="text-sm text-green-700 space-y-1">
                                <li>â€¢ Value premiums spike during market stress</li>
                                <li>â€¢ Regional variations in crisis responses</li>
                                <li>â€¢ Long-term positive trend for value</li>
                                <li>â€¢ Emerging markets show highest volatility</li>
                            </ul>
                        </div>

                        <div className="bg-purple-50 p-4 rounded-lg">
                            <h3 className="text-lg font-semibold text-purple-800 mb-2">Investment Implications</h3>
                            <ul className="text-sm text-purple-700 space-y-1">
                                <li>â€¢ Value strategies perform during downturns</li>
                                <li>â€¢ Regional diversification matters</li>
                                <li>â€¢ Market timing challenging</li>
                                <li>â€¢ Long-term value premium persistent</li>
                            </ul>
                        </div>
                    </div>

                    {/* Statistical Summary */}
                    <div className="bg-gray-50 p-4 rounded-lg">
                        <h3 className="text-lg font-semibold text-gray-800 mb-3">Statistical Summary (1993-2024)</h3>
                        <div className="overflow-x-auto">
                            <table className="w-full text-sm">
                                <thead>
                                    <tr className="border-b border-gray-300">
                                        <th className="text-left py-2 px-3">Region</th>
                                        <th className="text-right py-2 px-3">Avg Return (%)</th>
                                        <th className="text-right py-2 px-3">Std Dev (%)</th>
                                        <th className="text-right py-2 px-3">Reward/Risk</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr className="border-b border-gray-200 hover:bg-gray-100">
                                        <td className="py-2 px-3 font-medium">Developed Markets</td>
                                        <td className="text-right py-2 px-3">0.2462</td>
                                        <td className="text-right py-2 px-3">2.6399</td>
                                        <td className="text-right py-2 px-3">0.0933</td>
                                    </tr>
                                    <tr className="border-b border-gray-200 hover:bg-gray-100">
                                        <td className="py-2 px-3 font-medium">Emerging Markets</td>
                                        <td className="text-right py-2 px-3">0.7009</td>
                                        <td className="text-right py-2 px-3">2.2965</td>
                                        <td className="text-right py-2 px-3">0.3052</td>
                                    </tr>
                                    <tr className="border-b border-gray-200 hover:bg-gray-100">
                                        <td className="py-2 px-3 font-medium">European Markets</td>
                                        <td className="text-right py-2 px-3">0.3365</td>
                                        <td className="text-right py-2 px-3">2.6860</td>
                                        <td className="text-right py-2 px-3">0.1253</td>
                                    </tr>
                                    <tr className="border-b border-gray-200 hover:bg-gray-100">
                                        <td className="py-2 px-3 font-medium">Japanese Markets</td>
                                        <td className="text-right py-2 px-3">0.3711</td>
                                        <td className="text-right py-2 px-3">3.1276</td>
                                        <td className="text-right py-2 px-3">0.1187</td>
                                    </tr>
                                    <tr className="border-b border-gray-200 hover:bg-gray-100">
                                        <td className="py-2 px-3 font-medium">Asia-Pacific (ex Japan)</td>
                                        <td className="text-right py-2 px-3">0.5560</td>
                                        <td className="text-right py-2 px-3">3.0838</td>
                                        <td className="text-right py-2 px-3">0.1803</td>
                                    </tr>
                                    <tr className="hover:bg-gray-100">
                                        <td className="py-2 px-3 font-medium">North American Markets</td>
                                        <td className="text-right py-2 px-3">0.1246</td>
                                        <td className="text-right py-2 px-3">3.5337</td>
                                        <td className="text-right py-2 px-3">0.0353</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<ValuePremiumChart />, document.getElementById('root'));
    </script>
</body>
</html>
